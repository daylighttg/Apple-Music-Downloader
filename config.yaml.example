# ================================================================
# Apple Music 下载器配置文件模板
# ================================================================
# 
# 📝 使用说明：
# 1. 复制此文件为 config.yaml
# 2. 将 "your-media-user-token" 替换为你的真实 token
# 3. 根据需要配置各项参数
# 4. config.yaml 不会被提交到 Git（已在 .gitignore 中）
# 
# 🔐 如何获取 media-user-token：
# 1. 打开 Apple Music 网页版并登录
# 2. 打开开发者工具 (F12)
# 3. 进入 Application -> Cookies -> https://music.apple.com
# 4. 找到名为 "media-user-token" 的 cookie，复制其值
#
# ================================================================

# ================================================================
# 1. 账号配置 (Account Configuration)
# ================================================================
# 说明：
# - 下载专辑时，程序将从账号列表中轮流选取账号进行并行解密
# - 下载单曲时，程序根据链接区域 (如 /cn/, /us/) 自动匹配相同 storefront 的账号
# - 支持配置多个不同区域的账号
# ================================================================
accounts:
  - name: "CN"                    # 账号名称，方便识别
    storefront: "cn"              # 账号所属区域 (必须小写, 如 cn, us, jp, hk)
    media-user-token: "your-media-user-token-here"  # 替换为你的真实 token
    authorization-token: "your-authorization-token" # 可选，留空时程序会自动获取
    decrypt-m3u8-port: "127.0.0.1:10020"     # 解密服务端口
    get-m3u8-port: "127.0.0.1:10021"         # M3U8获取服务端口

  # 美国区账号示例 (取消注释以启用)
  # - name: "US"
  #   storefront: "us"
  #   media-user-token: "your-media-user-token-here"
  #   authorization-token: "your-us-auth-token"
  #   decrypt-m3u8-port: "127.0.0.1:20020"
  #   get-m3u8-port: "127.0.0.1:20021"

  # 日本区账号示例 (取消注释以启用)
  # - name: "JP"
  #   storefront: "jp"
  #   media-user-token: "your-media-user-token-here"
  #   authorization-token: "your-jp-auth-token"
  #   decrypt-m3u8-port: "127.0.0.1:30020"
  #   get-m3u8-port: "127.0.0.1:30021"


# ================================================================
# 2. 下载保存路径配置 (Save Path Configuration)
# ================================================================
alac-save-folder: "/media/Music/AppleMusic/Alac"        # ALAC 无损音频保存路径
atmos-save-folder: "/media/Music/AppleMusic/Atmos"      # Dolby Atmos 音频保存路径
mv-save-folder: "/media/Music/AppleMusic/MusicVideos"   # MV 视频保存路径


# ================================================================
# 3. 缓存机制配置 (Cache Configuration)
# ================================================================
# 说明：
# - 启用后先下载到本地缓存文件夹，处理完成后再移动到目标路径
# - 适用于 NFS 等网络文件系统，可显著提升效率和稳定性
# ================================================================
enable-cache: false               # 是否启用缓存机制 (true/false)
cache-folder: "./Cache"           # 缓存文件夹路径 (支持相对路径或绝对路径)


# ================================================================
# 4. 下载性能配置 (Download Performance Configuration)
# ================================================================
# 说明：
# - 合理配置线程数和缓冲区大小可以优化下载速度和内存占用
# - 建议根据网络带宽和硬件性能调整参数
# ================================================================

# M3U8 切片下载配置
chunk_downloadthreads: 30         # M3U8 切片并行下载线程数

# 网络与缓冲配置
NetworkReadBufferKB: 4096         # 网络读取缓冲区大小 (KB)
BufferSizeKB: 4                   # I/O 缓冲区大小 (KB)，过大会导致内存占用过高

# 音频下载线程配置 (最低为 1)
aac_downloadthreads: 5            # AAC 格式下载线程数
lossless_downloadthreads: 5       # 无损格式下载线程数
hires_downloadthreads: 5          # Hi-Res 高解析度下载线程数

# MV 视频下载配置
mv_chunk_downloadthreads: 30      # MV 视频切片并行下载线程数
mv_downloadthreads: 3             # MV 视频文件并行下载线程数

# 分批下载配置（大型专辑优化）
batch-size: 20                    # 每批处理的曲目数量，0 表示不分批（一次性处理所有曲目）
                                  # 建议值: 小型专辑设为 0，大型专辑（100+ 曲目）设为 20-50


# ================================================================
# 5. FFmpeg 配置 (FFmpeg Configuration)
# ================================================================
# 说明：
# - 用于检测和修复音频编码问题
# - 推荐开启自动检测，可在下载完成后修复潜在的编码错误
# ================================================================
ffmpeg-fix: true                  # 是否在下载完成后检测编码问题 (推荐开启)
ffmpeg-check-args: "-map 0:a:0 -f wav -hide_banner -loglevel error -"  # 检测参数
ffmpeg-encode-args: "-c:v copy -c:a alac -avoid_negative_ts make_zero -f mp4 -y"  # 重编码参数


# ================================================================
# 6. 语言与区域配置 (Language & Region Configuration)
# ================================================================
# 说明：
# - 留空时自动检测系统语言
# - 各区域支持的语言列表: https://gist.github.com/itouakirai/c8ba9df9dc65bd300094103b058731d0
# ================================================================
language: ""                      # 语言代码，例如 "zh-CN", "en-US"，留空则自动检测


# ================================================================
# 7. 歌词配置 (Lyrics Configuration)
# ================================================================
# 说明：
# - 程序会自动识别链接区域并使用对应账号获取歌词
# - 当链接区域不在账号列表时，使用默认区域获取歌词
# ================================================================
default-lyric-storefront: "cn"    # 默认歌词区域
lrc-type: "lyrics"                # 歌词类型: "lyrics" (普通歌词) 或 "syllable-lyrics" (逐字歌词)
lrc-format: "lrc"                 # 歌词格式: "lrc" 或 "ttml"
embed-lrc: true                   # 是否将歌词嵌入音频文件
save-lrc-file: false              # 是否将歌词另存为 .lrc 文件


# ================================================================
# 8. 封面与插图配置 (Cover & Artwork Configuration)
# ================================================================
# 说明：
# - 封面格式支持 jpg、png 或保持原格式
# - 动画插图和 Emby 动画插图需要安装 ffmpeg
# ================================================================
embed-cover: true                 # 是否嵌入封面到音频文件
cover-size: "5000x5000"           # 封面尺寸
cover-format: "jpg"               # 封面格式: "jpg", "png", "original"
save-artist-cover: true           # 是否保存歌手头像
save-animated-artwork: true       # 是否保存动画插图 (需要 ffmpeg)
emby-animated-artwork: true       # 是否生成 Emby 动画插图 (需要 ffmpeg)


# ================================================================
# 9. M3U8 与音频格式配置 (M3U8 & Audio Format Configuration)
# ================================================================
# 说明：
# - 控制 M3U8 获取方式和音频格式偏好
# ================================================================

# M3U8 获取配置
get-m3u8-from-device: true        # 是否从设备获取 M3U8
get-m3u8-mode: "hires"            # M3U8 获取模式: "all" (获取所有) 或 "hires" (仅探测 Hi-Res)

# 音频格式偏好
aac-type: "aac-lc"                # AAC 类型: "aac-lc", "aac", "aac-binaural", "aac-downmix"
alac-max: 192000                  # ALAC 最大采样率: 192000, 96000, 48000, 44100
atmos-max: 2768                   # Atmos 最大码率: 2768, 2448


# ================================================================
# 10. MV 视频下载配置 (Music Video Download Configuration)
# ================================================================
# 说明：
# - 控制 MV 视频的下载行为和质量偏好
# ================================================================
download-videos: true             # 是否下载 MV 视频 (true: 开启, false: 关闭)
mv-audio-type: "atmos"            # MV 音轨偏好: "atmos", "ac3", "aac"
mv-max: 2160                      # MV 视频分辨率偏好 (如 2160p, 1080p, 720p)


# ================================================================
# 11. 路径与字符限制配置 (Path & Character Limit Configuration)
# ================================================================
# 说明：
# - 留空时自动检测系统: Windows 255, Linux/macOS 4096
# - 其他系统请根据实际情况测试
# ================================================================
max-path-length: 255              # 绝对路径字符限制
limit-max: 200                    # 歌手、专辑、曲目名的最大字符数


# ================================================================
# 12. 文件命名格式配置 (File Naming Format Configuration)
# ================================================================
# 说明：
# - 使用变量自定义文件夹和文件名格式
# - 可用变量详见各配置项的注释
# ================================================================

# 专辑文件夹命名格式
# 可用变量: {AlbumId}, {AlbumName}, {ArtistName}, {ReleaseDate}, {ReleaseYear}, {UPC}, {Copyright}, {Quality}, {Codec}, {Tag}, {RecordLabel}
album-folder-format: "{AlbumName} {Tag}"

# 播放列表文件夹命名格式
# 可用变量: {PlaylistId}, {PlaylistName}, {ArtistName}, {Quality}, {Codec}, {Tag}
playlist-folder-format: "{PlaylistName}"

# 歌曲文件命名格式
# 可用变量: {SongId}, {SongNumer}, {SongName}, {DiscNumber}, {TrackNumber}, {Quality}, {Codec}, {Tag}
song-file-format: "{SongNumer}. {SongName}"

# 艺术家文件夹命名格式
# 可用变量: {ArtistId}, {ArtistName}, {UrlArtistName}
# 留空则不创建艺术家文件夹
artist-folder-format: "{UrlArtistName}"


# ================================================================
# 13. 特殊标签配置 (Special Tag Configuration)
# ================================================================
# 说明：
# - 在文件名中显示的特殊标签标识
# ================================================================
explicit-choice: "[E]"            # 显式内容标识
clean-choice: "[C]"               # 净化版本标识
apple-master-choice: "[M]"        # Apple Digital Master 标识


# ================================================================
# 14. 播放列表元数据配置 (Playlist Metadata Configuration)
# ================================================================
# 说明：
# - 控制播放列表的元数据处理策略
# ================================================================
use-songinfo-for-playlist: false  # 是否为播放列表使用歌曲信息
dl-albumcover-for-playlist: false # 是否为播放列表下载专辑封面
